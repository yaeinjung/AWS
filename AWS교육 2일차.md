<h2>AWS교육 2일차</h2>

**복습

object Level Storage

S3 : 저장된 데이터 Data Lake 역할

EC2에 어떤 SW를 설치하느냐에 따라서 해당 컴퓨팅자원으로 쓸 수 있음

인스턴스에 네트워크를 통해서 Storage가 붙어있음

관계형-비관계형중 어떤것을 써야하는지

관계형 : 한군데 데이터를 집중적으로 모아서 관리하는데 좋음

비관계 : 대량의 데이터를 모을때 좋음 (아무데이터나 막 모을때/key-value, document(Dynamo DB))



------

<h4>VPC(Virtual Private Cloud)</h4>

퍼블릭클라우드를 마치 혼자쓰는것처럼 Private하게 만들어주는 네트워크공간

<u>여러 사용자가 쓰는 클라우드를 나혼자 쓰는것처럼.</u>

* 서브넷 방식이 아닌 CIDR

* 리전마다 default VPC가 있음

* `클러스터 ⊂ 가용영역 ⊂ VPC ⊂ 리전` <<AWS계정

* 고성능 컴퓨팅은 하나의 VPC를 써야함. 분산되어있으면 퍼포먼스가 떨어지니까

* 대부분은 2개의 기본패턴을 사용함

  * 다중VPC or 복수계정
  * ex. 개발VPC, 테스트VPC, .....

* VPC를 나눈걸로도 부족하면 여러개 **AWS계정을분리**  (더 높은 수준의 resource를 사용하고 싶을때)

* `CIDR`

  * 각 8개, 
  * /32 -> 해당주소만
  * /22 -> 1024 (2^10(=32-22))

* `라우팅 테이블`

  * 리전에 접속하면 기본적으로 디폴트 VPC가 생성, 
  * 나눠서 쓰고싶으면 서브넷으로 나눠쓰면됨. 
  * 서브넷마다는 기본적으로 라우팅테이블이 하나씩 연결되어있음

* `퍼블릭서브넷` vs `프라이빗서브넷`

  * 프라이빗 : 인터넷게이트웨이에 대한 라우팅 정보가 없는 서브넷

    		프라이빗서브넷에는 NAT게이트웨이가 있는 퍼블릭서브넷으로 갈 수 있는 정보가 있음

  * 퍼블릭 : 인터넷게이트웨이에 대한 라우팅 정보가 있음

    		퍼블릭서브넷은 무조건 공인 IP를 가지고 있어야함

* 대부분 리소스는 프라이빗에 두는 것이 안전

* 웹 애플리케이션 인스턴스도 프라이빗에 두는것이 좋음 >> `로드밸런서`를 통해서 찾아들어가도록



<h4>클라우드 보안</h4>

* 보안그룹 : 인스턴스레벨의 방화벽
  * 기본적인 보안그룹은 인바운드 트래픽은 모두 차단
  * 아웃바운드 트래픽은 모두 허용
* 기본값으로 1000개까지 룰을 지정할 수 있고 3000개 까지 늘릴 수 있음. 
  * hypervisor의 리소스를 쓰는거기 때문에 룰을 많이 걸면 걸수록 hypervisor의 리소스를 쓰는것이므로 너무 많이 쓰지 않는것이 좋음
* 서브넷 > 라우팅테이블
* 인스턴스 > 보안그룹



<h4>Dx</h4>

* AWS Direct Connect
  * DX를 사용하여 온프레미스 네트워크를 AWS로 확장



<h4>VPC 피어링</h4>

* VPC를 연결
* 프라이빗 IP를 사용
* CIDR 중복 x



<h4>Transit Gateway</h4>

네트워크 허브 담당

* Trasit Gateway내 라우팅테이블에 목적지 정보가 담겨있음



<h4>VPC 엔드포인트</h4>

* 동일리전내에서만 사용가능
* 인터넷 사용하지 않아도됨. 인터넷으로 나가지 않고 AWS내에서 안전하게 처리하기 위함
* 종류
  * 인터페이스 엔드포인트
  * 게이트웨이 엔드포인트(ex.S3, Dynamo DB) - VPC 바깥에 있음
* VPC 안에있는 리소스가 VPC 바깥쪽에 접근할 수 있도록하는 것이 목적
* 온프레미스와 연결할때 DX로 할수도 있고 VPN으로 할 수도 있음

<h4>ELB</h4>

* Route53 : AWS 내 DNS서비스 
* 장애대비.



------

<h4>IAM</h4>

루트사용자 : 모든권한을 갖고 있음. 왠만하면 사용하지 말기

* 거부 > 허용 > 거부 순으로 체크, 항상 우선순위는 deny
  * 명시된 거부 체크
  * 명시된 허용 체크
  * 나머지는 거부
  * IAM 권한은 허용 안되어있으면 거부.

* 정책

  * 리소스기반     : 리소스한테 권한을 줌 (S3,Glacier...)

    			항상 인라인정책(일회성)

    			ex. 정책중 principal "x" 들어있음

  * 자격증명기반 : 인증(Authorization). 사용자에게 정책을 줌

    			ex. 사용자가 어떤 리소스에 뭐를 할 수 있는지 표시

* `ARN(Amazon Resource Name) `: 리소스를 식별하기 위한 정보

* 보안주체한테 권한을 부여하지 않고 항상 Role을 줌

  * STS 임시자격증명요청

* 임시권한을 줘야할때는 Role 사용
* 